schema: '2.0'
stages:
  labelling:
    cmd: python src/experiment/labelling.py data/csv/clinical-data.csv data/csv/pup.csv
      -o data/labels.csv
    deps:
    - path: data/csv/clinical-data.csv
      md5: 8fa7576fc3a3814f333348ba7998f0e1
      size: 813380
    - path: data/csv/pup.csv
      md5: 1a723b47b127c02cd9e77f5fabde35cf
      size: 203576
    - path: src/experiment/labelling.py
      md5: b0db448cb8d91503c5d71fbecabec53d
      size: 3604
    outs:
    - path: data/labels.csv
      md5: fb5f091f2626760ca2f20ac475ec9ad3
      size: 82527
  prepare:
    cmd: python src/experiment/prepare.py data/raw data/labels.csv data/prepared
    deps:
    - path: data/labels.csv
      md5: fb5f091f2626760ca2f20ac475ec9ad3
      size: 82527
    - path: data/raw
      md5: 5e6b4d71e0e68fe8f98c0af0e8fb6bdb.dir
      size: 17375510643
      nfiles: 103
    - path: src/experiment/prepare.py
      md5: 3bdaf1348bac65048fb3f49bf49892c5
      size: 4672
    params:
      params.yaml:
        prepare.num_samples: 20
        prepare.seed: 1234
    outs:
    - path: data/prepared
      md5: cb8008d8acd35f6b901e2486e9df9b7c.dir
      size: 441652301
      nfiles: 42
  extractframes:
    cmd: python src/experiment/images2frames.py data/prepared/labelled-images.csv
      data/prepared/scans data/frames
    deps:
    - path: data/prepared/labelled-images.csv
      md5: e5096ddb47ed9a3df1e82cbb39f855fa
      size: 1747
    - path: data/prepared/scans
      md5: 8e853f4d0b92c566717ef9763ce0aabc.dir
      size: 441650176
      nfiles: 40
    - path: src/experiment/images2frames.py
      md5: 6391cebc56a997cead8fcb2842b760cc
      size: 3825
    params:
      params.yaml:
        extractframes.n_frames: 20
    outs:
    - path: data/frames
      md5: 590eb50dfbe1d40ad09184d1cd5aa90b.dir
      size: 6751838
      nfiles: 800
  evaluate:
    cmd: python src/experiment/evaluate.py data/frames data/evaluation
    deps:
    - path: data/frames
      md5: 590eb50dfbe1d40ad09184d1cd5aa90b.dir
      size: 6751838
      nfiles: 800
    - path: src/experiment/evaluate.py
      md5: fd74bcef47d6df7080598b82d638bef7
      size: 3513
    params:
      params.yaml:
        evaluate.batch_size: 128
        evaluate.decay_rate: 0.96
        evaluate.initial_learning_rate: 5e-05
        evaluate.max_epochs: 10000
        evaluate.patience: 35
        evaluate.seed: 1234
        evaluate.validation_split: 0.2
    outs:
    - path: data/evaluation/scores.json
      md5: be2ef71420f2813d4a72636eb2b991ac
      size: 170
    - path: data/evaluation/weights.h5
      md5: 351efb5b712f1e92d3c955a0ea867405
      size: 6585792
  train:
    cmd: python src/experiment/train.py data/frames data/model
    deps:
    - path: data/frames
      md5: 590eb50dfbe1d40ad09184d1cd5aa90b.dir
      size: 6751838
      nfiles: 800
    - path: src/experiment/train.py
      md5: f0a7563fac36f8c18dbeecf70984ffd3
      size: 1478
    params:
      params.yaml:
        train.batch_size: 128
        train.decay_rate: 0.96
        train.epochs: 40
        train.initial_learning_rate: 5e-05
        train.seed: 1234
    outs:
    - path: data/model/memento.h5
      md5: 0ea91ac11468f1f7b7f0dda3a1929970
      size: 6585792
